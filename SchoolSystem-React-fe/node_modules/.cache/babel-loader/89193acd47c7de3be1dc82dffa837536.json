{"ast":null,"code":"var _jsxFileName = \"/Users/mohamedmaqil/Desktop/RIVO/rivo-portal-ui/src/providers/ContactFormProvider.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, createContext } from \"react\";\nimport { useApiError } from \"./ApiErrorProvider\";\nimport { useCustomer } from \"./CustomerProvider\";\nimport { getI18n } from \"react-i18next\";\nimport convertBase64 from \"../helpers/ConvertBase64\";\nimport SignRequest from \"../helpers/SignRequest\";\nimport { error } from \"../constants/bindings\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ContactFormContext = /*#__PURE__*/createContext({\n  loading: false,\n  submitFormValues: (submittedValues, file) => {}\n});\nexport const ContactFormProvider = props => {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const {\n    setErrorCode\n  } = useApiError();\n  const {\n    customerData\n  } = useCustomer();\n\n  const submitFormValues = async (submittedValues, file) => {\n    let fileAttachement = {};\n\n    if (file.length !== 0) {\n      const base64File = await convertBase64(file);\n      fileAttachement = {\n        contentType: file.type,\n        name: file.name,\n        body: base64File\n      };\n    }\n\n    try {\n      const createCaseData = constructCreateCaseData(customerData, submittedValues, fileAttachement);\n      console.log(\"createCaseData: \", createCaseData);\n      setLoading(true);\n      const data = await SignRequest(\"POST\", process.env.REACT_APP_API_BASE, process.env.REACT_APP_AKAMAI_DBAAS_API_URL, \"/create_case/details\", createCaseData).then(signedRequest => {\n        return fetch(signedRequest.api, {\n          method: \"POST\",\n          headers: signedRequest.headers,\n          body: signedRequest.data\n        });\n      }).then(response => response.json()).then(response => {\n        return response;\n      });\n\n      if (data !== null && data !== void 0 && data.success) {// sucess! return data\n      } else if (data !== null && data !== void 0 && data.status.includes(\"ERROR\")) {\n        return {\n          status: \"ERROR\",\n          message: data === null || data === void 0 ? void 0 : data.message\n        };\n      }\n\n      return data;\n    } catch (e) {\n      var _e$response;\n\n      if ((_e$response = e.response) !== null && _e$response !== void 0 && _e$response.status) {\n        var _e$response2;\n\n        setErrorCode((_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : _e$response2.status);\n      } else {\n        setErrorCode(error.CREATE_CASE);\n      }\n\n      setLoading(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(ContactFormContext.Provider, {\n    value: {\n      loading,\n      submitFormValues\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ContactFormProvider, \"GgtU9f9xLQ0NgriVixcALCp7tlA=\", false, function () {\n  return [useApiError, useCustomer];\n});\n\n_c = ContactFormProvider;\n\nconst constructCreateCaseData = (customerData, submittedValues, fileAttachement) => {\n  let attachment = {\n    ContentType: \"\",\n    Name: \"\",\n    Body: \"\"\n  }; // clean up attachment file\n\n  if (Object.keys(fileAttachement).length !== 0 && fileAttachement.body.includes(\"base64,\")) {\n    const startIndex = fileAttachement.body.indexOf(\"base64,\");\n    const sanitizedFile = fileAttachement.body.slice(startIndex + 7);\n    attachment = {\n      ContentType: fileAttachement.contentType,\n      Name: fileAttachement.name,\n      Body: sanitizedFile\n    };\n  } // obtain the case report type id\n\n\n  const caseReportTypeId = '' + process.env.REACT_APP_CASE_REPORT_TYPE_ID; // adjust description for case number issue type\n\n  const description = submittedValues.issueType === \"Portal - e-Tailer: Follow-up on an existing case\" ? \"Case #: \" + submittedValues.trackingNumber + \" ; \" + submittedValues.description : submittedValues.description;\n  const data = {\n    AccountId: customerData[0].accountId,\n    ContactId: customerData[0].contactId,\n    RecordType: caseReportTypeId,\n    IssueType: submittedValues.issueType,\n    Subject: \"Question from Rivo Web Site Support page\",\n    Description: description,\n    Language: getI18n().resolvedLanguage === \"en\" ? \"English\" : \"French\",\n    TrackingNumber: submittedValues.trackingNumber,\n    Attachment: Object.keys(fileAttachement).length !== 0 ? attachment : undefined\n  };\n  return data;\n};\n\nexport const useContactForm = () => {\n  _s2();\n\n  const context = React.useContext(ContactFormContext);\n  return context;\n};\n\n_s2(useContactForm, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"ContactFormProvider\");","map":{"version":3,"sources":["/Users/mohamedmaqil/Desktop/RIVO/rivo-portal-ui/src/providers/ContactFormProvider.tsx"],"names":["React","useState","createContext","useApiError","useCustomer","getI18n","convertBase64","SignRequest","error","ContactFormContext","loading","submitFormValues","submittedValues","file","ContactFormProvider","props","setLoading","setErrorCode","customerData","fileAttachement","length","base64File","contentType","type","name","body","createCaseData","constructCreateCaseData","console","log","data","process","env","REACT_APP_API_BASE","REACT_APP_AKAMAI_DBAAS_API_URL","then","signedRequest","fetch","api","method","headers","response","json","success","status","includes","message","e","CREATE_CASE","children","attachment","ContentType","Name","Body","Object","keys","startIndex","indexOf","sanitizedFile","slice","caseReportTypeId","REACT_APP_CASE_REPORT_TYPE_ID","description","issueType","trackingNumber","AccountId","accountId","ContactId","contactId","RecordType","IssueType","Subject","Description","Language","resolvedLanguage","TrackingNumber","Attachment","undefined","useContactForm","context","useContext"],"mappings":"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","sourcesContent":["import React, { useState, createContext } from \"react\";\nimport { useApiError } from \"./ApiErrorProvider\";\nimport { useCustomer } from \"./CustomerProvider\";\nimport { AttachementInterface, CreateCaseDataInterface } from \"../interfaces/CreateCaseDataInterface\";\nimport { getI18n } from \"react-i18next\";\nimport convertBase64 from \"../helpers/ConvertBase64\";\nimport SignRequest from \"../helpers/SignRequest\";\nimport { error } from \"../constants/bindings\";\n\nconst ContactFormContext = createContext({\n  loading: false,\n  submitFormValues: (submittedValues, file) => {}\n});\n\nexport const ContactFormProvider = props => {\n\n  const [loading, setLoading] = useState(false);\n  const { setErrorCode } = useApiError();\n  const { customerData } = useCustomer();\n\n  const submitFormValues = async (submittedValues, file) => {\n    let fileAttachement = {};\n    if (file.length !== 0) {\n      const base64File = await convertBase64(file);\n      fileAttachement = {\n        contentType: file.type,\n        name: file.name,\n        body: base64File\n      };\n    }\n\n    try {\n      const createCaseData = constructCreateCaseData(customerData, submittedValues, fileAttachement);\n      console.log(\"createCaseData: \", createCaseData);\n      \n\n      setLoading(true);\n      const data = await SignRequest(\n        \"POST\",\n        process.env.REACT_APP_API_BASE,\n        process.env.REACT_APP_AKAMAI_DBAAS_API_URL,\n        \"/create_case/details\",\n        createCaseData\n      )\n        .then((signedRequest) => {\n          return fetch(signedRequest.api, {\n            method: \"POST\",\n            headers: signedRequest.headers,\n            body: signedRequest.data\n          });\n        })\n        .then((response) => response.json())\n        .then((response) => {\n          return response;\n        });\n\n      if (data?.success){\n        // sucess! return data\n      } else if (data?.status.includes(\"ERROR\")) {\n        return ({\n          status: \"ERROR\",\n          message: data?.message\n        });\n      }\n      return data;\n    } catch (e: any) {\n      if (e.response?.status) {\n        setErrorCode(e.response?.status);\n      } else {\n        setErrorCode(error.CREATE_CASE);\n      }\n      setLoading(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <ContactFormContext.Provider value={{ loading, submitFormValues }}>\n      {props.children}\n    </ContactFormContext.Provider>\n  );\n};\n\nconst constructCreateCaseData = (customerData, submittedValues: any, fileAttachement: any) => {\n\n  let attachment: AttachementInterface = {\n    ContentType: \"\",\n    Name: \"\",\n    Body: \"\"\n  };\n\n  // clean up attachment file\n  if (Object.keys(fileAttachement).length !== 0 && fileAttachement.body.includes(\"base64,\")) {\n    const startIndex = fileAttachement.body.indexOf(\"base64,\");\n    const sanitizedFile = fileAttachement.body.slice(startIndex + 7);\n    attachment = {\n      ContentType: fileAttachement.contentType,\n      Name: fileAttachement.name,\n      Body: sanitizedFile\n    }\n  }\n\n  // obtain the case report type id\n  const caseReportTypeId = '' + process.env.REACT_APP_CASE_REPORT_TYPE_ID;\n\n  // adjust description for case number issue type\n  const description =\n    (submittedValues.issueType === \"Portal - e-Tailer: Follow-up on an existing case\")\n      ? \"Case #: \" +\n        submittedValues.trackingNumber +\n        \" ; \" +\n        submittedValues.description\n      : submittedValues.description;\n\n  const data: CreateCaseDataInterface = {\n    AccountId: customerData[0].accountId,\n    ContactId: customerData[0].contactId,\n    RecordType: caseReportTypeId,\n    IssueType: submittedValues.issueType,\n    Subject: \"Question from Rivo Web Site Support page\",\n    Description: description,\n    Language: getI18n().resolvedLanguage ===  \"en\" ? \"English\": \"French\",\n    TrackingNumber: submittedValues.trackingNumber,\n    Attachment: Object.keys(fileAttachement).length !== 0 ? attachment : undefined\n  }\n  return data;\n}\n\nexport const useContactForm = () => {\n  const context = React.useContext(ContactFormContext);\n  return context;\n};\n"]},"metadata":{},"sourceType":"module"}